{% extends 'admin_site/layout.html' %}
{% block 'main' %}
{% load humanize %}

<div class="col-lg-10 offset-lg-1 col-md-12">
    <div class="card">
        <div class="card-body">
            <h5 class="card-title">Bulk Upload Staff</h5>
            
            {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-success alert-dismissible fade show" role="alert">
                        <i class="bi bi-check-circle-fill me-2"></i>
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            {% endif %}

            <div class="alert alert-info">
                <h6 class="alert-heading">How This Works</h6>
                <p>This tool allows you to create or update multiple staff records at once by uploading an Excel file. The process runs in the background, so you can navigate away after starting the upload.</p>
                <hr>
                <p class="mb-0">The system is smart: it uses a combination of <strong>First Name, Last Name, and Gender</strong> to identify staff. If a staff member already exists, their Email and Mobile will be updated. If they don't exist, a new record will be created.</p>
            </div>

            <form method="POST" enctype="multipart/form-data" class="row g-3">
                {% csrf_token %}

                <div class="col-12">
                    <label for="{{ form.excel_file.id_for_label }}" class="form-label"><strong>{{ form.excel_file.label }}</strong> <span class="text-danger">*</span></label>
                    {{ form.excel_file }}
                    {% if form.excel_file.help_text %}
                        <div class="form-text">{{ form.excel_file.help_text }}</div>
                    {% endif %}
                    {% if form.excel_file.errors %}
                        <div class="invalid-feedback d-block">{{ form.excel_file.errors.0 }}</div>
                    {% endif %}
                </div>

                <div class="text-start mt-3">
                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-upload"></i> Upload and Process File
                    </button>
                    <a href="#" onclick="window.history.back();" class="btn btn-secondary">Cancel</a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}